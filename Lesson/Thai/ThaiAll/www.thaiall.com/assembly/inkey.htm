<html>
<!-- Mirrored from www.thaiall.com/assembly/inkey.htm by HTTrack Website Copier/3.x [XR&CO'2008], Mon, 21 Dec 2009 05:44:39 GMT -->
<head><title>การสร้างโปรแกรม inkey.com</title>
<meta http-equiv=content-type content="text/html; charset=windows-874">
<meta name="keywords" content="inkey,assembly,computer,organization,programming,language,principles">
<meta name="description" content="การสร้างโปรแกรม inkey.com">
<style type="text/css">
body{font-family:microsoft sans serif;font-size:10pt}
a:link{color:red;}
a:visited{color:purple;}
textarea{font-family:microsoft sans serif;color:blue;background-color:#ddffdd}
td{font-size:10pt;font-family:microsoft sans serif;}
</style>
</head>
<body text=black bgcolor=white topmargin=0 leftmargin=0>
<table width=100% cellpadding=0 cellspacing=0 border=0 bgcolor=#808080><tr bgcolor=red height=1><td colspan=3> </td></tr>
<tr><td><a href=http://www.thaiall.com/me><img src=ta1.gif border=0></a></td><td align=center><font color=white>
การสร้างโปรแกรม inkey.com</td><td align=right><a href=http://www.thaiall.com/sponsor.htm><img src=ta2.gif border=0></a></td></tr><tr bgcolor=#dddddd height=3><td colspan=3> </td></tr>
</table>

<br>ปรับปรุง : 2551-06-30 (เพิ่ม key.com และ keyall.com)
<br> 

<a name=inkey></a>
<ul>
<font color=blue size=6><b>1. inkey.com หยุดรับค่าจากแป้นพิมพ์ 1 อักษร</b></font>
<dd>inkey.com จะรับรหัส ascii ส่งให้ errorlevel ที่ batchfile สามารถนำไปสามารถรับไปตรวจสอบด้วย if ต่อไปได้ แต่ถ้า run นอก batchfile โปรแกรมนี้ก็จะไม่แสดงผลใด ๆ ทางจอภาพทั้งสิ้น
<table width=80%><td valign=top>
<font face="courier new" color=red><pre><font color=black><b>inkey.scr</b></font>
n inkey.com
e 0100 b4 08 cd 21 b4 4c cd 21
rcx
0008
w
q
<td valign=top><img src=debug.gif></table>
</font><hr color=black>

<font color=blue size=6><b>2. เมนูแสดงการใช้ inkey.com</b></font>
<table><td>
<font face="courier new" color=red><pre><font color=black><b>menu1.bat</b></font>
@echo off
:menu
cls 
echo a: dir
echo 0: bye
inkey.com
if errorlevel 65 if not errorlevel 66 goto dodirw
if errorlevel 97 if not errorlevel 98 goto dodirw
if errorlevel 48 if not errorlevel 49 goto end
goto menu
:dodirw
dir /w
goto end
:end
echo bye bye
</pre></font>
</table>
<hr color=black>

<font color=blue size=6><b>3. key.com ใช้หยุดรับค่าจากแป้นพิมพ์ 1 อักษร</b></font>
<dd>จาก Computer Review ปีที่ 11 ฉบับ 113 มกราคม 2537 หน้า 239 โดย มาลิน
<dd>key.com จะรับรหัส ascii ส่งให้ errorlevel ถ้าเป็นพิมพ์ใหญ่ จะแปลงเป็นพิมพ์เล็กให้ การใช้ if ใน Batch file จึงลดการตรวจสอบได้
<table><td width=49% valign=top>
<font face="courier new" color=red><pre><font color=black><b>key.scr</b></font>
n key.com
e 0100 b4 00 cd 16 3c 7a 77 06 3c 60 76 02
e 010c 24 df 3c 00 75 02 88 e0 b4 4c cd 21
rcx
0018
w
q
<hr><font color=green>
61 = "a" = 0110 0001
7A = "z" = 0111 1100
41 = "A" = 0100 0001
5A = "A" = 0101 1100
DF = 1101 1111
<hr>
JA = Jump if Above ถ้าสูงกว่า
JBE = Jump if Below
JNZ = Jump if Not Zero
</font>
<td bgcolor=gray width=2>
<td width=49% valign=top><pre><font color=black><b>C:\>debug key.com</b></font><font face="courier new" color=red>
-u
<font color=red>0C53:0100 B400     MOV     AH,00
0C53:0102 CD16     INT     16</font>
0C53:0104 3C7A     CMP     AL,7A
0C53:0106 7706     JA      010E
<font color=blue>0C53:0108 3C60     CMP     AL,60
0C53:010A 7602     JBE     010E</font>
<font color=green>0C53:010C 24DF     AND     AL,DF
0C53:010E 3C00     CMP     AL,00
0C53:0110 7502     JNZ     0114</font>
0C53:0112 88E0     MOV     AL,AH
0C53:0114 B44C     MOV     AH,4C
0C53:0116 CD21     INT     21
</font></pre></font>
</table>
<hr color=black>

<font color=blue size=6><b>4. เมนูแสดงการใช้ key.com</b></font>
<table><td>
<font face="courier new" color=red><pre>
<font color=black><b>menu2.bat</b></font>
@echo off
:menu
cls 
echo a: dir
echo 0: bye
key.com
if errorlevel 65 if not errorlevel 66 goto dodirw
if errorlevel 48 if not errorlevel 49 goto end
goto menu
:dodirw
dir /w
goto end
:end
echo bye bye
</pre></font>
</table>

<center>
<! v 7.2549.10 >
<form action=http://www.thaiall.com/cgi/srchweb.pl method=post><hr color=red>
<a href=http://www.thaiall.com/cgi/putting.pl>แนะนำเว็บใหม่</a> : <a href=http://www.thaiall.com/rangeweb.htm>ผลการจัดอันดับ</a>
<input type=text name=SearchText Size=10><input type=submit value=สืบค้นเว็บไซต์>
<br><a href=http://www.lovelampang.com/>รักลำปาง</a> : <a href=http://lampang.thcity.com/>thcity.com</a> : <a href=http://www.korattown.com/>korattown.com</a> : <a href=http://www.topsiam.com/>topsiam.com</a> : <a href=http://www.yonok.ac.th/>มหาวิทยาลัยโยนก</a>
<br><a href=http://www.thaiall.com/quiz>ศูนย์สอบ</a> : <a href=http://www.thaiall.com/article>รวมบทความ</a> : <a href=http://www.thaiall.com/itinlife>ไอทีในชีวิตประจำวัน</a> :  <a href=http://www.thaiall.com/download>ดาวน์โหลด</a> : <a href=http://mail.thaiall.com/>yourname@thaiall.com</a>
<br>ติดต่อ <a href=http://www.thaiall.com/me>ทีมงาน</a> ชาวลำปาง <a href=http://www.thaiall.com/me/dream.htm>มีฝันเพื่อการศึกษา</a> Tel.08-1992-7223
</form>
<script language=javascript>
<!--
url=document.location.href.substr(7,11)
page="assembly_inkey"
if(url == "lampang.thc") document.write("<script language='javascript1.1' src='../../hits1.truehits.net/data/h0013199.js'></script>")
if(url == "www.yonok.a") document.write("<script language='javascript1.1' src='../../hits1.truehits.net/data/c0001943.js'></script>")
if(url == "www.thaiall") document.write("<script language='javascript1.1' src='../../hits1.truehits.net/data/c0001941.js'></script>")
if(url == "www.perlphp") document.write("<script language='javascript1.1' src='../../hits1.truehits.net/data/h0013336.js'></script>")
if(url == "thaiall.kor") document.write("<script language='javascript1.1' src='../../hits0.truehits.net/data/k0020653.js'></script>")
-->
</script>
</body>
<!-- Mirrored from www.thaiall.com/assembly/inkey.htm by HTTrack Website Copier/3.x [XR&CO'2008], Mon, 21 Dec 2009 05:44:40 GMT -->
</html>
