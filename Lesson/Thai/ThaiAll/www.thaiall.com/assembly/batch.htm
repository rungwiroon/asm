<html>
<!-- Mirrored from www.thaiall.com/assembly/batch.htm by HTTrack Website Copier/3.x [XR&CO'2008], Mon, 21 Dec 2009 05:41:58 GMT -->
<head><title>คำสั่งดอส ในแบทช์ไฟล์ (DOS Command in Batch File)</title>
<meta http-equiv=content-type content="text/html; charset=windows-874">
<meta name=keywords content="batch,program,dos,manual">
<meta name=description content="การเขียนแบทช์ไฟล์ โดยใช้คำสั่งดอสทั้งแบบคำสั่งภายใน และคำสั่งภายในนอก">
<style type="text/css">
body{font-family:microsoft sans serif;font-size:10pt}
a:link{color:red;}
a:visited{color:purple;}
textarea{font-family:microsoft sans serif;color:blue;background-color:#ddffdd}
td{font-size:10pt;font-family:microsoft sans serif;}
</style>
</head>
<body text=black bgcolor=white topmargin=0 leftmargin=0>
<table width=100% cellpadding=0 cellspacing=0 border=0 bgcolor=#808080><tr bgcolor=red height=1><td colspan=3> </td></tr>
<tr><td><a href=http://www.thaiall.com/me><img src=ta1.gif border=0></a></td><td align=center><font color=white>
คำสั่งดอส ในแบทช์ไฟล์ (DOS Command in Batch File)</td><td align=right><a href=http://www.thaiall.com/sponsor.htm><img src=ta2.gif border=0></a></td></tr><tr bgcolor=#dddddd height=3><td colspan=3> </td></tr>
</table>

<br>ปรับปรุง : 2552-08-26 (แก้แนะนำเว็บ)
<br> 

<table width=760 align=center><td valign=top width=460><div align=justify>
<ul><b>Batch Processing</b> <a href=http://th.wikipedia.org/wiki/Batch_processing>?</a>
<dd>การประมวลผลแบบแบทช์ คือ วิธีการประมวลผลที่ทำการเก็บรวบรวมข้อมูลในแต่ละช่วงเวลาไว้ก่อน  จนกว่าจะมีข้อมูลที่ประมวลผลจำนวนหนึ่ง จึงทำการประมวลผลพร้อมกัน เช่น เวลาเข้าออกของพนักงานอาจจะพิมพ์เก็บไว้ทุกสัปดาห์ แต่นำมาประมวลผลเดือนละครั้งเท่านั้น
<br><b>BAT file</b> 
<dd>(BATch file) A file of DOS or OS/2 commands, which are executed one after the other. It has a .BAT extension and is created with a text editor. A file of DOS commands that are "batch" processed one after the other. Windows also supports batch files, which are mostly identical to the DOS commands.
To create a DOS batch file, use a text editor such as Edit. If you use a word processor, save your batch file as an ASCII text file, not as a standard document. Always include a .BAT extension with your batch file name.
<br>+ <a href=http://www.techweb.com/encyclopedia/defineterm.jhtml?term=DOSbatchfile>http://www.techweb.com/encyclopedia</a>
<td bgcolor=gray width=1> <td valign=top width=300><pre>+ <a href=http://uva.ulb.ac.be/cit_courseware/msdos/msdos21.htm>http://uva.ulb.ac.be/cit_courseware</a>
@echo  off
rem   check  to  see  if  a  file  exists
if  exist  %1  goto  fileexists
goto  nofile
:fileexists
echo  the  file  %1  exists
rem  other  commands  here .....
goto  end
:nofile
echo  the  file  %1  does  not  exist
goto  end
:end</pre>
</table>

<table width=760 align=center bgcolor=#f9f9f9 bordercolor=gray border=1 cellspacing=0>
<tr><td colspan=3 align=center bgcolor=#ddffdd><b>ฝึกเขียนคำสั่งที่จะใช้ใน Batch File</b>
<tr><td>1 <td>cls<td width=400>ล้างจอภาพ (Clear Screen)
<tr><td>2 <td>@echo off<td>ไม่แสดงการทำงานของคำสั่งใน Batch File
<tr><td>3 <td>dir /?<td>.
<tr><td>4 <td>dir > a<td>.
<tr><td>5 <td>dir a<td>.
<tr><td>6 <td>echo aa<td>.
<tr><td>7 <td>echo aa > a.bat<td>.
<tr><td>8 <td>echo aa >> a.bat<td>.
<tr><td>9 <td>type a.bat<td>.
<tr><td>10 <td>copy con a.bat<td>.
<tr><td>11 <td>pause<td>.
<tr><td>12 <td>del a.bat<td>.
<tr><td>13 <td>md a<td>.
<tr><td>14 <td>deltree a<td>.
<tr><td>15 <td>cd \<td>.
<tr><td>16 <td>cd a<td>.
<tr><td>17 <td>cd ..<td>.
<tr><td>18 <td>cd ..\b<td>.
<tr><td>19 <td>rd a<td>ลบห้อง a
<tr><td>20 <td>dir a /w/s<td>แสดงรายชื่อแฟ้มในห้อง a
<tr><td>21 <td>echo y | del c:\windows\command.com<td>.
<tr><td>22 <td>if  exist  %1  goto  fileexists<td>.
<tr><td>23 <td>shutdown -r -f -t 0<td>สั่ง restart force ปิดเครื่องไม่เตือน ทันที
<tr><td>24 <td>ipconfig /release<td>ยกเลิก IP Address ที่มีอยู่
<tr><td>25 <td>ipconfig /renew<td>ขอ IP Address ใหม่จากเครื่องบริการ DHCP
<tr><td>26 <td>:x<br>net send * workgroup enabled<br>goto x<td>ทำการรบกวนระบบเครือข่าย
<tr><td>27 <td>break off<td>ทำให้ไม่สามารถยกเลิกการทำงานของ Batch File
<tr><td>28 <td>echo @echo off > c:\x.bat<br>echo break off >> c:\x.bat<br>echo ipconfig /release_all >> c:\x.bat<td>ใช้ batch file สร้าง batch file 
<tr><td>29 <td colspan=2>Title แก้ไขให้เรียก x.bat ผ่าน register<br>reg add hklm\software\microsoft\windows\currentversion\run /v mybat /t reg_sz /d c:\x.bat /f <br>reg add hkcu\software\microsoft\windows\currentversion\run /v mybat /t reg_sz /d c:\x.bat /f
<tr><td>30 <td colspan=2>reg query hklm\software\microsoft\windows\currentversion\run<br>reg delete hkcu\software\microsoft\windows\currentversion\run /v CONTROLexit /f
<tr><td>31 <td colspan=2>reg delete hklm\software\microsoft\windows\currentversion\policies\system /v DisableTaskMgr /f
<tr><td>32 <td>for %%f in (*.asm) do tasm %%f<br>for %%f in (*.obj) do tlink /t %%f<td>.
<tr><td>33 <td>attrib > burin | find "H" burin<td>แสดงรายชื่อแฟ้มที่ซ่อนอยู่ แทน grep ใน Linux
</table>
<br>
<table width=760 align=center>
<tr bgcolor=#800000><td colspan=2><font color=white>
<b>ตัวอย่าง 1</b>
<dd>สร้าง folder และแฟ้มด้วย <b>boy1.bat</b>
<dd><b>คำถามคือ</b> สร้าง boy1.bat โดยดูผลลัพธ์ได้ไหม</td></tr>
<tr bgcolor=#ffffdd><td valign=top><font color=blue face="courier new"><ul><pre>
@echo off
cd \
md abc
cd abc
md aa
md bb
cd aa
echo a > a1
echo b > a2
dir > a3
dir > a4
copy * ..\bb
cd \
dir abc /s/w
</pre></ul></td><td bgcolor=#dddddd><img src=batch.png>
<br><b>Result of running</b>
<font color=#000080 face="courier new"><pre>
C:\&gt;z
a1
a2
a3
a4
        4 file(s) copied.
Volume in drive C has no label.
Volume Serial Number is C876-B72B
Directory of C:\abc
[.]  [..] [aa] [bb]
               0 File(s)       0 bytes

Directory of C:\abc\aa
[.]  [..] a1   a2   a3   a4
               4 File(s)      875 bytes

Directory of C:\abc\bb
[.]  [..] a1   a2   a3   a4
               4 File(s)      875 bytes

     Total Files Listed:
               8 File(s)    1,750 bytes
               8 Dir(s)   786,496 bytes free
C:\>
</pre></td></tr>
</table>

<br>

<table width=760 align=center>
<tr bgcolor=#800000><td><font color=white>
<b>ตัวอย่าง 2</b>
<dd>สร้าง <b>boy2.bat</b> สร้างแปล และประมวลผล java 
<dd><b>คำถามคือ</b> ท่านจะแก้ปัญหา เมื่อทดสอบได้หรือไม่ และ output ที่ได้คืออะไร</td></tr>
<tr bgcolor=#ffffdd><td valign=top><font color=blue face="courier new"><ul><pre>
@echo off
echo help to write Java program and compile and execute
echo wait for result
echo ==================================================
cd c:\j2sdk1.4.2_03\bin\
echo class boy2 { > boy2.java
echo public static void main(String args[]) { >> boy2.java
echo System.out.println("oho batch file"); } } >> boy2.java
javac boy2.java
java boy2
</pre></ul></td></tr>
</table>
<br>
<table width=760 align=center>
<tr bgcolor=#800000><td><font color=white>
<b>ตัวอย่าง 3</b>
<dd>สร้าง <b>boy3.bat</b> รับค่าผ่าน command line 
<dd><b>คำถามคือ</b> ผลลัพธ์เป็นอย่างไร ในแต่ละตัวอย่าง
<dd>เช่น<font face="courier new"> 
<dd>c:\>boy3 a b c
<dd>c:\>boy3 burin
<dd>c:\>boy3 burin b c
<dd>c:\>boy3 a loop c
<dd>c:\>boy3 a b loop
</td></tr>
<tr bgcolor=#ffffdd><td valign=top><font color=blue face="courier new"><ul><pre>
@echo off
set aaa=wow wow
echo %aaa%
echo %TEMP%
echo =======================
echo %0
echo %1
echo %2
echo =======================
set
pause
cls
if .%1 == .burin goto burin
if .%2 == .loop goto loop1
if .%3 == .loop goto loop2
goto end
:burin
echo burin rujjanapan
dir /w
goto end
:loop1
for %%x in (aa bb cc) do echo %%x
goto end
:loop2
for %%x in (%1 %2 %3) do echo %%x
goto end
:end
echo bye
</pre></font></ul></td></tr>
</table></font>
<br><br>
<table width=760 align=center bgcolor=#f9f9f9 bordercolor=gray border=1 cellspacing=0><td>
<b>ไวรัสอาจเพิ่ม register ทำให้การใช้งานมีปัญหา</b>
<textarea rows=10 cols=100 wrap=off>
reg delete hkcu\software\microsoft\windows\currentversion\policies\system /v disablecmd /f
reg delete hkcu\software\microsoft\windows\currentversion\policies\system /v disableregistrytools /f
reg delete hkcu\software\policies\microsoft\internet explorer\control panel /v homepage /f
reg add hkcu\software\microsoft\windows\currentversion\explorer\advanced /v hidden /t reg_dword /d 2 /f
reg add hkcu\software\microsoft\windows\currentversion\explorer\advanced\folder\hidden\showall /v checkedvalue /t reg_dword /d 1 /f
reg add hkcu\software\microsoft\windows\currentversion\explorer\advanced /v hidefileext /t reg_dword /d 0
reg add hkcu\software\microsoft\windows\currentversion\explorer\advanced /v hidden /t reg_dword /d 2
reg add hkcu\software\microsoft\windows\currentversion\explorer\advanced /v hidefileext /t reg_dword /d 0
reg add hklm\system\currentcontrolset\services\sharedaccess /v start /t reg_dword /d 4
reg delete hkcu\software\microsoft\windows\currentversion\policies\system /v disabletaskmgr /f
reg delete hklm\software\microsoft\windows\currentversion\policies\system /v disableregistrytools /f
reg delete hklm\software\microsoft\windows\currentversion\policies\system /v disablecmd /f
reg delete hklm\software\microsoft\windows\currentversion\policies\system /v disabletaskmgr /f
reg add hklm\system\currentcontrolset\services\sharedaccess /v start /t reg_dword /d 2 /f
reg delete hkcu\software\microsoft\windows\currentversion\policies\explorer /v nofolderoptions /f
reg delete hkcu\software\microsoft\windows\currentversion\policies\explorer /v nostartmenumoreprograms /f
reg delete hkcu\software\microsoft\windows\currentversion\policies\explorer /v nofind /f
reg delete hkcu\software\microsoft\windows\currentversion\policies\explorer /v nostartmenumfuprogramslist /f
reg delete hkcu\software\microsoft\windows\currentversion\policies\explorer /v nostartmenusubfolders /f
reg delete hkcu\software\microsoft\windows\currentversion\policies\explorer /v nochangestartmenu /f
reg delete hkcu\software\microsoft\windows\currentversion\policies\explorer /v nosavesettings /f
reg delete hkcu\software\microsoft\windows\currentversion\policies\explorer /v nobandcustomize /f
reg delete hkcu\software\microsoft\windows\currentversion\policies\explorer /v nomovingbands /f
reg delete hkcu\software\microsoft\windows\currentversion\policies\explorer /v noclosedragdropbands /f
reg delete hkcu\software\microsoft\windows\currentversion\policies\explorer /v nosettaskbar /f
reg delete hkcu\software\microsoft\windows\currentversion\policies\explorer /v notoolbarsontaskbar /f
reg delete hkcu\software\microsoft\windows\currentversion\policies\explorer /v noactivedesktop /f
reg delete hkcu\software\microsoft\windows\currentversion\policies\explorer /v classicshell /f
reg delete hkcu\software\microsoft\windows\currentversion\policies\explorer /v noclose /f
reg delete hkcu\software\microsoft\windows\currentversion\policies\explorer /v nologoff /f
reg delete hkcu\software\microsoft\internet explorer\main /v window title /f
</textarea></td></table>

<br><br>
<table width=760 align=center bgcolor=#f9f9f9 bordercolor=gray border=1 cellspacing=0><td>
<b>ตรวจ host ในเครือข่ายว่า response หรือไม่</b>
<textarea rows=10 cols=100 wrap=off>
rem ถ้าขณะ ping มี ip ใดช้าก็ส่งสัยไว้ก่อนได้เลย
ping 192.168.10.5 -n 1 >c:\pingwireless.txt
ping 192.168.10.6 -n 1 >>c:\pingwireless.txt
ping 192.168.10.7 -n 1 >>c:\pingwireless.txt
ping 192.168.10.8 -n 1 >>c:\pingwireless.txt
ping 192.168.10.9 -n 1 >>c:\pingwireless.txt
ping 192.168.10.10 -n 1 >>c:\pingwireless.txt
ping 192.168.10.11 -n 1 >>c:\pingwireless.txt
ping 192.168.10.12 -n 1 >>c:\pingwireless.txt
ping 192.168.10.13 -n 1 >>c:\pingwireless.txt
ping 192.168.10.14 -n 1 >>c:\pingwireless.txt
ping 192.168.10.15 -n 1 >>c:\pingwireless.txt
ping 192.168.10.16 -n 1 >>c:\pingwireless.txt
ping 192.168.10.17 -n 1 >>c:\pingwireless.txt
ping 192.168.10.18 -n 1 >>c:\pingwireless.txt
ping 192.168.10.19 -n 1 >>c:\pingwireless.txt
ping 192.168.10.20 -n 1 >>c:\pingwireless.txt
ping 192.168.10.21 -n 1 >>c:\pingwireless.txt
ping 192.168.10.22 -n 1 >>c:\pingwireless.txt
ping 192.168.10.23 -n 1 >>c:\pingwireless.txt
ping 192.168.10.24 -n 1 >>c:\pingwireless.txt
ping 192.168.10.25 -n 1 >>c:\pingwireless.txt
ping 192.168.10.26 -n 1 >>c:\pingwireless.txt
ping 192.168.10.27 -n 1 >>c:\pingwireless.txt
ping 192.168.10.28 -n 1 >>c:\pingwireless.txt
ping 192.168.10.29 -n 1 >>c:\pingwireless.txt
ping 192.168.10.30 -n 1 >>c:\pingwireless.txt
ping 192.168.10.31 -n 1 >>c:\pingwireless.txt
ping 192.168.10.32 -n 1 >>c:\pingwireless.txt
ping 192.168.10.33 -n 1 >>c:\pingwireless.txt
ping 192.168.10.34 -n 1 >>c:\pingwireless.txt
ping 192.168.10.35 -n 1 >>c:\pingwireless.txt
ping 192.168.10.36 -n 1 >>c:\pingwireless.txt
rem บ้านดร. ping 192.168.10.37 -n 1 >>c:\pingwireless.txt
ping 192.168.10.38 -n 1 >>c:\pingwireless.txt
ping 192.168.10.39 -n 1 >>c:\pingwireless.txt
ping 192.168.10.40 -n 1 >>c:\pingwireless.txt
ping 192.168.10.41 -n 1 >>c:\pingwireless.txt
ping 192.168.10.42 -n 1 >>c:\pingwireless.txt
rem ชั้น 3 บริหาร ping 192.168.10.43 -n 1 >>c:\pingwireless.txt
sort c:\pingwireless.txt
notepad c:\pingwireless.txt
pause
</textarea></td></table>

<ol><b>แนะนำเว็บ (Web Guides)</b>
<li><a href=http://www.fpschultze.de/bsh.htm>http://www.fpschultze.de/bsh.htm</a> (สุดยอด)
<li><a href=http://www.computerhope.com/batch.htm>http://www.computerhope.com/batch.htm</a>
<li><a href=http://gearbox.maem.umr.edu/batch/exmp1.htm>http://gearbox.maem.umr.edu/batch/exmp1.htm</a>
<li><a href=http://www.ericphelps.com/batch/index.htm>http://www.ericphelps.com/batch/index.htm</a>
<li><a href=http://www.ericphelps.com/batch/tricks/index.htm>http://www.ericphelps.com/batch/tricks/index.htm</a>
</ol>


<center>
<! v 7.2549.10 >
<form action=http://www.thaiall.com/cgi/srchweb.pl method=post><hr color=red>
<a href=http://www.thaiall.com/cgi/putting.pl>แนะนำเว็บใหม่</a> : <a href=http://www.thaiall.com/rangeweb.htm>ผลการจัดอันดับ</a>
<input type=text name=SearchText Size=10><input type=submit value=สืบค้นเว็บไซต์>
<br><a href=http://www.lovelampang.com/>รักลำปาง</a> : <a href=http://lampang.thcity.com/>thcity.com</a> : <a href=http://www.korattown.com/>korattown.com</a> : <a href=http://www.topsiam.com/>topsiam.com</a> : <a href=http://www.yonok.ac.th/>มหาวิทยาลัยโยนก</a>
<br><a href=http://www.thaiall.com/quiz>ศูนย์สอบ</a> : <a href=http://www.thaiall.com/article>รวมบทความ</a> : <a href=http://www.thaiall.com/itinlife>ไอทีในชีวิตประจำวัน</a> :  <a href=http://www.thaiall.com/download>ดาวน์โหลด</a> : <a href=http://mail.thaiall.com/>yourname@thaiall.com</a>
<br>ติดต่อ <a href=http://www.thaiall.com/me>ทีมงาน</a> ชาวลำปาง <a href=http://www.thaiall.com/me/dream.htm>มีฝันเพื่อการศึกษา</a> Tel.08-1992-7223
</form>
<script language=javascript>
<!--
url=document.location.href.substr(7,11)
page="assembly_batch"
if(url == "lampang.thc") document.write("<script language='javascript1.1' src='../../hits1.truehits.net/data/h0013199.js'></script>")
if(url == "www.yonok.a") document.write("<script language='javascript1.1' src='../../hits1.truehits.net/data/c0001943.js'></script>")
if(url == "www.thaiall") document.write("<script language='javascript1.1' src='../../hits1.truehits.net/data/c0001941.js'></script>")
if(url == "www.perlphp") document.write("<script language='javascript1.1' src='../../hits1.truehits.net/data/h0013336.js'></script>")
if(url == "thaiall.kor") document.write("<script language='javascript1.1' src='../../hits0.truehits.net/data/k0020653.js'></script>")
-->
</script>
</body>
<!-- Mirrored from www.thaiall.com/assembly/batch.htm by HTTrack Website Copier/3.x [XR&CO'2008], Mon, 21 Dec 2009 05:41:59 GMT -->
</html>
