;////////////////////////////////////////////////////////////////
VERIFY_TABLE	PROC
	
	MOV	TEMP_BX,-1
	MOV	CHECK_POINT2,0

SEARCH_BLANK:

	INC	TEMP_BX
	MOV	BX,TEMP_BX

	CMP	TEMP_BX,63
	JG	END_VERIFY

	CMP	[TABLE+BX],0
	JNE	SEARCH_BLANK
	
	MOV	POSITION,BL
	CALL	TO_ROW
	MOVM	TEMP_ROW2,ROW
	MOVM	TEMP_COL2,COL

	CALL	CHECK_PASS

	CMP	CHECK_POINT2,1
	JE	END_VERIFY
	JMP	SEARCH_BLANK
END_VERIFY :

		
	CMP	CHECK_POINT2,1
	JE	SET_ABLE_IS_1		;NOT PASS
	JNE	SET_ABLE_IS_0		;PASS

SET_ABLE_IS_1 :

	CMP	SET_PLAY,1
	JE	SET_PL1_IS_1
	JNE	SET_PL2_IS_1

SET_PL1_IS_1 :

	MOV	PL1_ABLE,1		;PLAYER1 CAN PUT MAK
	RET

SET_PL2_IS_1 :

	MOV	PL2_ABLE,1
	RET

SET_ABLE_IS_0 :

	CMP	SET_PLAY,1
	JE	SET_PL1_IS_0
	JNE	SET_PL2_IS_0


SET_PL1_IS_0 :				;SET WHITE PASS
	
	MOV	PL1_ABLE,0		

	CMP	PL2_ABLE,0		;BLACK PASS ?
	JE	END_GAME

	GOTO_XY	1,23
	MOV	AH,09H
	LEA	DX,MSG_WHITE_PASS
	INT	21H

	WAITCLICK

	GOTO_XY	1,23
	MOV	AH,09H
	LEA	DX,MSG_BLANK
	INT	21H

	GOTO_XY	3,23
	MOV	AH,09H
	LEA	DX,MSG_BLANK
	INT	21H

	MOV	SET_PLAY,2		;CHANGE PLAYER

	RET
SET_PL2_IS_0 :				;SET BLACK PASS

	MOV	PL2_ABLE,0		

	CMP	PL1_ABLE,0		;WHITE PASS ?
	JE	END_GAME

	GOTO_XY	30,23
	MOV	AH,09H
	LEA	DX,MSG_BLACK_PASS
	INT	21H

	WAITCLICK

	GOTO_XY	30,23
	MOV	AH,09H
	LEA	DX,MSG_BLANK
	INT	21H

	GOTO_XY	33,23
	MOV	AH,09H
	LEA	DX,MSG_BLANK
	INT	21H

	MOV	SET_PLAY,1		;CHANGE PLAYER

	RET

VERIFY_TABLE	ENDP

;////////////////////////////////////////////////////////////////////
;////////////////////////////////////////////////////////////////////
;////////////////////////////////////////////////////////////////////

CHECK_PASS	PROC

	MOV	CHECK_POINT2,0

SET_PASS1 :

	MOV	COUNT,0
	MOVM	TEMP_ROW,TEMP_ROW2
	MOVM	TEMP_COL,TEMP_COL2

COUNT_CHECK1 :

	INC	TEMP_COL

	CMP	TEMP_COL,8
	JNLE	SET_PASS2

	CALL	TO_POS
	XOR	BX,BX
	MOV	BL,POSITION

	CMP	[TABLE+BX],0
	JE	SET_PASS2

	MOV	AL,SET_PLAY
	CMP	[TABLE+BX],AL
	JE	SET_CHECK_POINT2_1
	INC	COUNT
	JMP	COUNT_CHECK1

SET_CHECK_POINT2_1 :

	CMP	COUNT,0
	JNG	SET_PASS2
	MOV	CHECK_POINT2,1

;///////////////////////////////////////////////////////
SET_PASS2 :

	MOV	COUNT,0
	MOVM	TEMP_ROW,TEMP_ROW2
	MOVM	TEMP_COL,TEMP_COL2

COUNT_CHECK2 :

	DEC	TEMP_COL

	CMP	TEMP_COL,1
	JNGE	SET_PASS3

	CALL	TO_POS
	XOR	BX,BX
	MOV	BL,POSITION

	CMP	[TABLE+BX],0
	JE	SET_PASS3

	MOV	AL,SET_PLAY
	CMP	[TABLE+BX],AL
	JE	SET_CHECK_POINT2_2
	INC	COUNT
	JMP	COUNT_CHECK2

SET_CHECK_POINT2_2 :

	CMP	COUNT,0
	JNG	SET_PASS3
	MOV	CHECK_POINT2,1

;///////////////////////////////////////////////////////

SET_PASS3 :

	MOV	COUNT,0
	MOVM	TEMP_ROW,TEMP_ROW2
	MOVM	TEMP_COL,TEMP_COL2

COUNT_CHECK3 :

	INC	TEMP_ROW

	CMP	TEMP_ROW,8
	JNLE	SET_PASS4

	CALL	TO_POS
	XOR	BX,BX
	MOV	BL,POSITION

	CMP	[TABLE+BX],0
	JE	SET_PASS4

	MOV	AL,SET_PLAY
	CMP	[TABLE+BX],AL
	JE	SET_CHECK_POINT2_3
	INC	COUNT
	JMP	COUNT_CHECK3

SET_CHECK_POINT2_3 :

	CMP	COUNT,0
	JNG	SET_PASS4
	MOV	CHECK_POINT2,1

;///////////////////////////////////////////////////////
SET_PASS4 :

	MOV	COUNT,0
	MOVM	TEMP_ROW,TEMP_ROW2
	MOVM	TEMP_COL,TEMP_COL2

COUNT_CHECK4 :

	DEC	TEMP_ROW

	CMP	TEMP_ROW,1
	JNGE	SET_PASS5

	CALL	TO_POS
	XOR	BX,BX
	MOV	BL,POSITION

	CMP	[TABLE+BX],0
	JE	SET_PASS5

	MOV	AL,SET_PLAY
	CMP	[TABLE+BX],AL
	JE	SET_CHECK_POINT2_4
	INC	COUNT
	JMP	COUNT_CHECK4

SET_CHECK_POINT2_4 :

	CMP	COUNT,0
	JNG	SET_PASS5
	MOV	CHECK_POINT2,1
	
;///////////////////////////////////////////////////////
SET_PASS5 :

	MOV	COUNT,0
	MOVM	TEMP_ROW,TEMP_ROW2
	MOVM	TEMP_COL,TEMP_COL2

COUNT_CHECK5 :

	INC	TEMP_ROW
	DEC	TEMP_COL

	CMP	TEMP_ROW,8
	JNLE	SET_PASS6

	CMP	TEMP_COL,1
	JNGE	SET_PASS6

	CALL	TO_POS
	XOR	BX,BX
	MOV	BL,POSITION

	CMP	[TABLE+BX],0
	JE	SET_PASS6

	MOV	AL,SET_PLAY
	CMP	[TABLE+BX],AL
	JE	SET_CHECK_POINT2_5
	INC	COUNT
	JMP	COUNT_CHECK5

SET_CHECK_POINT2_5 :

	CMP	COUNT,0
	JNG	SET_PASS6
	MOV	CHECK_POINT2,1

;///////////////////////////////////////////////////////

SET_PASS6 :

	MOV	COUNT,0
	MOVM	TEMP_ROW,TEMP_ROW2
	MOVM	TEMP_COL,TEMP_COL2

COUNT_CHECK6 :

	DEC	TEMP_ROW
	INC	TEMP_COL

	CMP	TEMP_COL,8
	JNLE	SET_PASS7

	CMP	TEMP_ROW,1
	JNGE	SET_PASS7

	CALL	TO_POS
	XOR	BX,BX
	MOV	BL,POSITION

	CMP	[TABLE+BX],0
	JE	SET_PASS7

	MOV	AL,SET_PLAY
	CMP	[TABLE+BX],AL
	JE	SET_CHECK_POINT2_6
	INC	COUNT
	JMP	COUNT_CHECK6

SET_CHECK_POINT2_6 :

	CMP	COUNT,0
	JNG	SET_PASS7
	MOV	CHECK_POINT2,1

;///////////////////////////////////////////////////////

SET_PASS7 :

	MOV	COUNT,0
	MOVM	TEMP_ROW,TEMP_ROW2
	MOVM	TEMP_COL,TEMP_COL2

COUNT_CHECK7 :

	INC	TEMP_ROW
	INC	TEMP_COL

	CMP	TEMP_ROW,8
	JNLE	SET_PASS8

	CMP	TEMP_COL,8
	JNLE	SET_PASS8

	CALL	TO_POS
	XOR	BX,BX
	MOV	BL,POSITION

	CMP	[TABLE+BX],0
	JE	SET_PASS8

	MOV	AL,SET_PLAY
	CMP	[TABLE+BX],AL
	JE	SET_CHECK_POINT2_7
	INC	COUNT
	JMP	COUNT_CHECK7

SET_CHECK_POINT2_7 :

	CMP	COUNT,0
	JNG	SET_PASS8
	MOV	CHECK_POINT2,1

;///////////////////////////////////////////////////////
SET_PASS8 :

	MOV	COUNT,0
	MOVM	TEMP_ROW,TEMP_ROW2
	MOVM	TEMP_COL,TEMP_COL2

COUNT_CHECK8 :

	DEC	TEMP_ROW
	DEC	TEMP_COL

	CMP	TEMP_ROW,1
	JNGE	CHECK_FOR_PASS

	CMP	TEMP_COL,1
	JNGE	CHECK_FOR_PASS

	CALL	TO_POS
	XOR	BX,BX
	MOV	BL,POSITION

	CMP	[TABLE+BX],0
	JE	CHECK_FOR_PASS

	MOV	AL,SET_PLAY
	CMP	[TABLE+BX],AL
	JE	SET_CHECK_POINT2_8
	INC	COUNT
	JMP	COUNT_CHECK8

SET_CHECK_POINT2_8 :

	CMP	COUNT,0
	JNG	CHECK_FOR_PASS
	MOV	CHECK_POINT2,1

;//////////////////////////////////////////////
CHECK_FOR_PASS :

	RET

CHECK_PASS	ENDP