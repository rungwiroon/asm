.MODEL SMALL
.STACK 100H
.CONST	
	INCLUDE MACRO.ASM
	INCLUDE	CHAR.ASM
	INCLUDE	NUM.ASM
	INCLUDE	PIC.ASM
	INCLUDE PICVALUE.ASM
.DATA
	CHOICE	   DB ?
.CODE

MAIN PROC
	MOV	AX,@DATA
	MOV	DS,AX
	MOV	ES,AX
	
	MOV	AH,00H		; OPEN GRAPHIC MODE 
	MOV	AL,13H
	INT	10H		
RETURNMENU_:
	MOV	HITS,0
	MOV	CHOICE,1
	CALL	LOADMENU
;=======================================
	CALL	RANDOMBLOCK
	CALL	RANDOMBLOCK
	CMP	CHOICE,4
	JL	KEYPRESS_
	CMP	CHOICE,5
	JE	LINK_SCORE_
	CMP	CHOICE,6
	JE	LINK_EXITGAME_
	JMP	RETURNMENU_
LINK_SCORE_:
	JMP	HIGH_SCORE_
LINK_EXITGAME_:
	JMP	EXITGAME_
;=======================================
KEYPRESS_:	
	CALL	GETKEY
	CMP	CHOICE,1
	JE	SHOW_NUMBLOCK_
	CMP	CHOICE,2
	JE	SHOW_CHARBLOCK_
	CMP	CHOICE,3
	JE	SHOW_PICBLOCK_
SHOW_NUMBLOCK_:
	CALL	OPENBLOCKNUM
	JMP	CONTINUE_GAME_
SHOW_CHARBLOCK_:	
	CALL	OPENBLOCKCHAR
	JMP	CONTINUE_GAME_
SHOW_PICBLOCK_:
	CALL	OPENBLOCKPIC
CONTINUE_GAME_:
	CALL	CHECKFINISH
	MOV	AL,CHECK
	CMP	AL,16
	JE	WINGAME_
	MOV	AL,KEY
	CMP	AL,27
	JE	LOSTGAME_
	CALL	HITSCORE
	MOV	BX,HITS
	CMP	BX,999
	JE	LOSTGAME_
	JNE	KEYPRESS_
WINGAME_:
	MOV	BMP_X,112
	MOV	BMP_Y,30
	MOV	gpw1,140
	MOV	gpw2,50	
	LEA	SI,PICWIN
	CALL	LOADPIC
	ADD	BMP_Y,55
	MOV	gpw2,30
	LEA	SI,G_NAME
	CALL	LOADPIC
	CALL	GETNAME
	JMP	ENDGAME_
LOSTGAME_:
	MOV	BMP_X,112
	MOV	BMP_Y,70
	MOV	gpw1,140
	MOV	gpw2,50	
	LEA	SI,PICLOST
	CALL	LOADPIC
	JMP	ENDGAME_
HIGH_SCORE_:

	JMP	ENDGAME_
ENDGAME_:
	CALL	RETURNDATABLOCK
	MOV	AH,8
	INT	21H
	JMP	RETURNMENU_

EXITGAME_:

	MOV	AX,0003H	; CLOSE GRAPHIC MODE 
	INT	10H		;
	
	MOV	AH,4CH		; EXIT TO DOS
	INT	21H
MAIN ENDP

	INCLUDE LOADBK.ASM
	INCLUDE	GRAPHIC.ASM
	INCLUDE	MENU.ASM
	INCLUDE	FILE.ASM
	include	outdec.asm
END