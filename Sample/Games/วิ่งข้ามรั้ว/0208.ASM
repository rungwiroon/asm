.MODEL	SMALL
.386
.STACK	100H

INCLUDE	MACRO.ASM

;==============================================
;EXTRA SEGMENT TO USE SAVE SCREEN
vbufferseg	segment	
	vbuffer db	64000	dup (0)
vbufferseg	ends
;==============================================

.DATA
;LOADBMP
	BMP_WIDTH	DW	?     
	BMP_HEIGHT	DW	?
	BMP_HANDLE	DW	?
	BMP_BUFFER 	DB  1024 DUP(?)
	BMP_X		DW	?     
	BMP_Y		DW	?
	BMP_X2		DW	?
	BMP_Y2		DW	?
	BMP_BLANK	DW	0
	TRANSPARENT	DB	01H
	BMP_MODE	DB	0
	COUNTCOLOR	DB	0
	BMP_COUNT	DW	0

;PICTURE	
	MENUPLAY	DB	'PIC\MENUPLAY.BMP',0
	MENUHIGH	DB	'PIC\MENUHIGH.BMP',0
	MENUHOW		DB	'PIC\MENUHOW.BMP',0
	MENUEXIT	DB	'PIC\MENUEXIT.BMP',0
	HOW1		DB	'PIC\HOW1.BMP',0
	HOW2		DB	'PIC\HOW2.BMP',0
	HOW3		DB	'PIC\HOW3.BMP',0
	READY		DB	'PIC\TRACK\READY.BMP',0
	GO			DB	'PIC\TRACK\GO.BMP',0
	FIRST		DB	'PIC\TRACK\FIRST1.BMP',0
	SECOND		DB	'PIC\TRACK\SECOND1.BMP',0
	FINISH		DB	'PIC\TRACK\FINISH1.BMP',0
	OVER		DB	'PIC\OVER.BMP',0
	POINT_BG    DB	'PIC\HI_SCORE.BMP',0
	YEAH		DB	'PIC\TRACK\YEAH.BMP',0
	GUN			DB	'PIC\GUN.BMP',0
	RUN			DB	'PIC\HUMAN\MAN1.BMP',0
	JUMP_UP		DB	'PIC\HUMAN\JUMP1.BMP',0
	JUMP_DOWN	DB	'PIC\HUMAN\JUMP3.BMP',0
	OBJECT		DB	'PIC\HANDLE.BMP',0
	OBJECT2		DB	'PIC\HANDLE2.BMP',0
	LINE		DB	'PIC\LINE.BMP',0
	CRASH		DB	'PIC\\HUMAN\CRASH.BMP',0
	ENTER_NAME	DB	'PIC\NAME.BMP',0	
	RESULT		DB	'PIC\TRACK\RESULT.BMP',0

;VARIABLE
	CHOICE		DB	1
	OBJ_X1		DW	?
	LINE_X		DW	?
	MAN_X		DW	?
	MAN_Y		DW	?
	MAN_YY		DW	?
	COUNT		DB	?
	
	NCRASH		DB	?
	RETURN		DB	?
	SCORE		DW	0
	POINT		DW	0

	NAME1		DB	10,0,10 DUP(0FFH)
	NAME2		DB      10 DUP(0),'$'
	NAME_REC        DB      11 DUP(10 DUP(0))
    SCORE_REC       DW      11 DUP(0)
	NUM             DW      0
    NUM2            DW      0
	FILESCORE       DB      'SCORE.BIN',0

	;TIME CLOCK
	TIME_BUF	DB	'00:00:00$'	;time buffer hr:min:sec
	
	SEC			DB	?
	M_SEC		DB	?
	SEC2		DB	?
	START_COUNT	DB	1	
	
	;TIMER
	NEW_TIMER_VEC	DW	?,?
	OLD_TIMER_VEC	DW	?,?
	
	TEMP		DW	?
			

.CODE

	MAIN	PROC	
	
	MOV	AX,@DATA
	MOV	DS,AX
	MOV	ES,AX
	
	MOV	AH,00H			;MODE 0 FUNCTION 13
	MOV	AL,13H			;GRAPHIC MODE 13H 320*200 256 COLOR
	INT	10H

MENU:	
	XOR	AX,AX
	CALL	SHOWMENU
	XOR	BX,BX
	MOV	RETURN,0
	MOV	NCRASH,0
	MOV	POINT,0
	MOV	START_COUNT,1
	
	CMP	CHOICE,1
	JE	CALL_PLAY
	CMP	CHOICE,2
	JE	CALL_HIGH
	CMP	CHOICE,3
	JE	HOW_TO_PLAY
	CMP	CHOICE,4
	JE 	EXIT

	
CALL_PLAY:
	CALL	PLAY_GAME
	MOV	CHOICE,1
	JMP	MENU
	
CALL_HIGH:
	CALL	HIGH_SCORE
	MOV	CHOICE,1
	JMP	MENU
	
HOW_TO_PLAY:
	CALL	MANUAL
	MOV	CHOICE,1
	JMP	MENU
	
EXIT:
	CALL	EXIT_GAME
	
	
	

	MAIN	ENDP
	
;====================================================
	MANUAL	PROC
	PUSHA
HOW_TO_PLAY1:	
	CALL	CLEAR_KEY_BUFF
	PASTEBMP	0,0,HOW1
	DELAY	500
	CALL	CLEAR_KEY_BUFF
	PASTEBMP	0,0,HOW2
	DELAY	500
	CALL	CLEAR_KEY_BUFF
	PASTEBMP	0,0,HOW3
	DELAY	500
	MOV	AH,01
	INT	16H
	CMP	AH,01
	JE	TO_MENU
	CALL	CLEAR_KEY_BUFF
	JMP	HOW_TO_PLAY
TO_MENU:
	POPA
	RET
	
	MANUAL	ENDP
;====================================================
	
	EXIT_GAME	PROC
	

	
	MOV	AH,00H
	MOV	AL,03H			;TEXT MODE 80COL 25ROW
	INT	10H
	
	MOV	AH,4CH
	INT	21H
	


	
	EXIT_GAME	ENDP
	

;============================================================
	
INCLUDE LOADBMP.ASM
INCLUDE	SHOWMENU.ASM
INCLUDE	PLAY_GAME.ASM
INCLUDE	HIGHSCORE.ASM
INCLUDE	GRAPHIC.ASM
INCLUDE	TIME.ASM
END
	
